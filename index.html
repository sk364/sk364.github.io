<html>
    <head>
        <title>Sachin Kukreja</title>
        <meta name=viewport content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link href='https://fonts.googleapis.com/css?family=Space+Mono' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="css/style.css"/>
        <link rel="stylesheet" href="css/animate.min.css">
    </head>
    <body class="animated fadeIn">
        <div class="outside">
            <table border="1" class="content">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>INTJ</th>
                        <th>ENFP</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Oct 25, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Oct 26, 2019</td>
                        <td>N</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Oct 27, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Oct 28, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Oct 29, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Oct 30, 2019</td>
                        <td>N</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Oct 31, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 01, 2019</td>
                        <td>N</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Nov 02, 2019</td>
                        <td>N</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Nov 03, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 04, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 05, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 06, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 07, 2019</td>
                        <td>N</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 08, 2019</td>
                        <td>N</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 09, 2019</td>
                        <td>Y</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>Nov 10, 2019</td>
                        <td>Y</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Nov 11, 2019</td>
                        <td>N</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Nov 12, 2019</td>
                        <td>N</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>Nov 13, 2019</td>
                        <td>Y</td>
                        <td>N</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
        var seasonLength = 10;
        var numBonusDays = 5;
        var numPunishDays = 3;

        $(document).ready(function() {
            var tableEl = $('table');
            var allCols = tableEl.find('td');
            var numRows = allCols.length / 3;
            var seasonScores = [];
            for (var i=0; i < numRows / seasonLength; i++) {
                var iSum = eSum = 0;
                var piStreak = peStreak = 0;
                var niStreak = neStreak = 0;
                for (var j=0; j < seasonLength; j++) {
                    var iCol = allCols[((i*seasonLength + j)*3) + 1];
                    var eCol = allCols[((i*seasonLength + j)*3) + 2];
                    if (!iCol || !eCol)
                        continue;
                    var iVal = 0;
                    var eVal = 0;
                    if (iCol.textContent==="Y")
                        iVal++;
                    else if (iCol.textContent==="N")
                        iVal--;
                    if (eCol.textContent==="Y")
                        eVal++;
                    else if (eCol.textContent==="N")
                        eVal--;

                    piStreak = iVal===1 ? piStreak+1 : 0;
                    peStreak = eVal===1 ? peStreak+1 : 0;
                    niStreak = iVal===-1 ? niStreak+1 : 0;
                    neStreak = eVal===-1 ? neStreak+1 : 0;

                    var iBonus = piStreak-numBonusDays > 0 ?
                        Math.pow(2, piStreak-numBonusDays) - 1 : 0;
                    var iPunish = niStreak-numPunishDays > 0 ?
                        Math.pow(2, niStreak-numPunishDays) - 1 : 0;
                    var eBonus = peStreak-numBonusDays > 0 ?
                        Math.pow(2, peStreak-numBonusDays) - 1 : 0;
                    var ePunish = neStreak-numPunishDays > 0 ?
                        Math.pow(2, neStreak-numPunishDays) - 1 : 0;

                    iSum += iVal + iBonus - iPunish;
                    eSum += eVal + eBonus - ePunish;
                }
                seasonScores.push([iSum, eSum]);
            }
            var offset = 1;
            var iTotal = eTotal = 0;
            seasonScores.forEach(function(scores, idx) {
                $('tbody > tr').eq(((idx + 1) * seasonLength) - offset).after(
                    '<tr><th>Season ' + (idx + 1) + '</th><th>' + scores[0] + '</th><th>' + scores[1] + '</th></tr>'
                );
                offset--;
                iTotal += scores[0];
                eTotal += scores[1];
            });
            $('tbody').append('<tr><th>Total Score</th><th>' + iTotal + '</th><th>' + eTotal + '</th></tr>')
        });
    </script>
</html>
